<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <link rel="stylesheet" href="css/trade.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <title>Zodiac Algo-trade</title>

  <style>
    /* Toggle Switch Styling */
    .toggle-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      gap: 10px;
    }

    .toggle-label {
      font-weight: bold;
      font-size: 1rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 30px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 22px;
      width: 22px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked+.slider {
      background-color: #4CAF50;
    }

    input:checked+.slider:before {
      transform: translateX(30px);
    }

    #mode-display {
      font-size: 1.1rem;
      color: #333;
      text-align: center;
      margin-bottom: 1rem;
    }
  </style>
</head>

<body>
  <div id="auto-analysis"></div>

  <form id="trade-form" aria-labelledby="form-heading">
    <h1 id="form-heading">Zodiac Algo-trade</h1>

    <!-- Top Toggle Only -->
    <div class="toggle-container">
      <span class="toggle-label">Manual</span>
      <label class="switch">
        <input type="checkbox" id="mode-toggle">
        <span class="slider"></span>
      </label>
      <span class="toggle-label">Automated</span>
    </div>
    <div id="mode-display">Current Mode: <strong>Manual</strong></div>

    <!-- Market Dropdown -->
    <label for="market">Market:</label>
    <select id="market" name="market" required>
      <option value="">Select Market</option>
      <option value="forex">Forex</option>
      <option value="indices">Indices</option>
      <option value="commodities">Commodities</option>
      <option value="cryptocurrency">Crypto</option>
      <option value="synthetic_index">Synthetic Index</option>
    </select>

    <!-- Submarket Dropdown -->
    <label for="submarket">Submarket:</label>
    <select id="submarket" name="submarket" disabled>
      <option value="">Select Submarket</option>
    </select>

    <!-- Contract Type Dropdown -->
    <label for="contract_type">Trade Type:</label>
    <select id="contract_type" name="contract_type" required>
      <option value="">Select Trade</option>
      <option value="up_and_down">Up and Down</option>
      <option value="digits">Digits</option>
    </select>

    <!-- Sentiment Dropdown -->
    <label for="sentiment">Sentiment:</label>
    <select id="sentiment" name="sentiment" required>
      <option value="">Select Sentiment</option>
    </select>

    <!-- Digits Input -->
    <div id="digit-value" style="display: none;">
      <label for="input-value">Digits:</label>
      <select name="input-value" id="input-value">
        <option value="">Select Digit</option>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
      </select>
    </div>

    <label for="price">Minimum: min 0.35</label>
    <input id="price" name="price" type="number" step="0.01" min="0.35" required>

    <!-- Submit Button -->
    <input type="submit" value="Run">
  </form>

  <!-- Loading Spinner -->
  <div class="loadingio-spinner-gear-5fyuz6nbepy" id="spinner-container" role="status" aria-live="polite">
    <div class="ldio-s69gk832n0l">
      <div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
  </div>

  <div id="loading-message" aria-live="polite"></div>
  <div id="results-container"></div>
  </div>

  <script type="module" src="/js/buyContract.mjs"></script>
  <script type="module" src="/js/formData.mjs"></script>
  <script type="module" src="/js/smart-ui.mjs"></script>
  <script type="module" src="/js/smart-over-under.mjs"></script>
  <script type="module" src="/js/even-odd.mjs"></script>
  <script type="module" src="/js/superMatches.mjs"></script>
  <script type="module" src="/js/simpleDiffers.mjs"></script>
  <script type="module" src="/js/sharpRecovery.mjs"></script>

  <!-- Disclaimer Bubble -->
  <div id="disclaimer-bubble" class="disclaimer-bubble">
    Disclaimer!
  </div>

  <!-- Disclaimer Modal -->
  <div id="disclaimer-modal" class="disclaimer-modal">
    <div class="disclaimer-content">
      <span class="close-btn" id="disclaimer-close">&times;</span>
      <h2>Risk Configuration</h2>
      <div class="disclaimer-text">
        <p>1.1. You may lose all the money you invest. Therefore, you should not trade or invest money that you cannot
          afford to lose. The services offered by Deriv are only suitable for you if you can afford to bear these losses
          and if you understand the risks involved in these trades.</p>
        <p>1.2. The returns and losses you experience will vary depending on many factors, including market behaviour,
          market movement, and your trade size. Markets may be volatile and unpredictable, which means that prices can
          change rapidly.</p>
        <p>1.3. Our services are provided on an execution-only basis, which means we do not give you financial advice on
          the merits of a transaction or any other investment advice.</p>
        <p>1.4. We may provide information on our Website, emails, or other platforms such as social media. The only
          purpose of this information is to help you and other traders make independent investment decisions. This
          information does not consider your personal circumstances and objectives. It should not be regarded as a
          personal recommendation or as research. We recommend you do your own research before making any trading
          decisions.</p>
        <p>1.5. We do not give any representation or warranty as to the accuracy or completeness of the information that
          we provide on our Website, emails, or other platforms such as social media. Information given may be accurate
          and correct at the time of publication, but changes in circumstances after the time of publication may impact
          the accuracy of the information. Performance figures quoted may refer to the past, and past performance is not
          a guarantee of future performance or a reliable guide to future performance.</p>
        <p>1.6. Trading conditions, products, and platforms may differ depending on your country of residence.</p>
        <p>1.7. The decision to open an account and use our products and services is entirely yours. It is important
          that you have adequate investment resources to bear such risks and monitor your positions carefully. You
          should make careful, considered, and independent decisions, both upon setting up an account and while using
          our online services.</p>
        <p>1.8. When you trade, you are exposed to the performance of an underlying or reference instrument or asset
          (which may include foreign exchange, indices, and commodities), each of which has its own features and risks.
          You should make sure you understand these risks before trading with us.</p>
        <p>1.9. International currency or commodity prices are highly volatile and difficult to predict. Therefore, no
          trade purchased in our system can be considered a safe trade, irrespective of whether the payout exceeds the
          initial capital amount or not.</p>
        <p>1.10. Trading our products does not give you any right to the underlying instrument of the transaction. Our
          products represent a notional value only.</p>
        <p>1.11. You should be aware that all trades through Deriv are made on over-the-counter (OTC) markets. This
          means that the trades we offer do not take place under the rules of any recognised, designated, or regulated
          exchange. As a result, engaging in these trades may expose you to substantially greater risks than the
          investments that are traded under such rules.</p>
        <p>1.12. Deriv is both the manufacturer and distributor of its products.</p>
        <p>1.13. Please note that prices in the market can change very quickly, so the execution price may not
          necessarily be instantly visible once your order has been filled.</p>
        <p>1.14. The value of your investments may go down as well as up.</p>
        <p>1.15. It is your responsibility to monitor all of your positions closely and make sure that your exposure
          matches your risk appetite. We have no responsibility to notify you of any instances where your positions are
          closed due to the unavailability of funds (for example, because you do not have sufficient margin in your
          trading account to maintain an open position). During the period that you have any open contracts, you should
          ensure that you have the ability to access any accounts you hold with Deriv.</p>
        <p>1.16. We may have access to information not available to you, acquired trading positions at prices not
          available to you, and interests different from your interests. We are not under any obligation to provide you
          with any information in our possession or interfere in your trading or trading decisions in any way.</p>
        <p>1.17. You are responsible for managing your tax and legal affairs, including making any required regulatory
          filings and/or payments and complying with any applicable laws and regulations. We do not provide any
          regulatory, tax, or legal advice. If you are in any doubt about the tax treatment or liabilities of the
          products available on our Website, please seek independent advice.</p>
        <p>1.18. If you are uncertain about how any of our products work or the relevant risks, we recommend you seek
          independent advice prior to opening an account with Deriv. You should not commence trading until you
          understand the risks involved.</p>
      </div>
    </div>
  </div>

  <script type="module" src="/js/disclaimer.mjs"></script>

  <script type="module">
    // Auto-populate Market â†’ Submarket Dropdowns
    document.addEventListener("DOMContentLoaded", async () => {
      let instruments = {};

      // Fetch from backend
      try {
        const res = await fetch("/api/data");
        instruments = await res.json();
        console.log("Loaded instruments:", instruments);
      } catch (error) {
        console.error("Error loading instruments:", error);
        return;
      }

    });
  </script>


  <script type="module">
    import { setAutomationMode, getAutomationMode } from "/js/buyContract.mjs";

    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', e => {
      if (e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && ['I', 'J'].includes(e.key)) ||
        (e.ctrlKey && e.key === 'U')) e.preventDefault();
    });

    document.addEventListener("DOMContentLoaded", () => {
      const toggle = document.getElementById("mode-toggle");
      const modeDisplay = document.getElementById("mode-display");

      // Load saved mode from localStorage
      const savedMode = localStorage.getItem("zodiac_mode") === "true";
      toggle.checked = savedMode;
      setAutomationMode(savedMode);
      modeDisplay.innerHTML = `Current Mode: <strong>${savedMode ? "Automated" : "Manual"}</strong>`;

      // Handle toggle change
      toggle.addEventListener("change", () => {
        const isAutomated = toggle.checked;
        localStorage.setItem("zodiac_mode", isAutomated);
        modeDisplay.innerHTML = `Current Mode: <strong>${isAutomated ? "Automated" : "Manual"}</strong>`;
        setAutomationMode(isAutomated);
      });
    });
  </script>
</body>

</html>